<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Rule Priority | ngx_waf</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="A web application firewall module for nginx without complex configuration.'">
    
    <link rel="preload" href="/ngx_waf/assets/css/0.styles.50317297.css" as="style"><link rel="preload" href="/ngx_waf/assets/js/app.782f3221.js" as="script"><link rel="preload" href="/ngx_waf/assets/js/2.765de306.js" as="script"><link rel="preload" href="/ngx_waf/assets/js/11.13f84e60.js" as="script"><link rel="prefetch" href="/ngx_waf/assets/js/10.e5175a4f.js"><link rel="prefetch" href="/ngx_waf/assets/js/12.c11e7e57.js"><link rel="prefetch" href="/ngx_waf/assets/js/13.31f90b21.js"><link rel="prefetch" href="/ngx_waf/assets/js/14.1a679090.js"><link rel="prefetch" href="/ngx_waf/assets/js/15.6d4cdfe7.js"><link rel="prefetch" href="/ngx_waf/assets/js/16.7ade88bb.js"><link rel="prefetch" href="/ngx_waf/assets/js/17.b82eee55.js"><link rel="prefetch" href="/ngx_waf/assets/js/18.585be541.js"><link rel="prefetch" href="/ngx_waf/assets/js/19.387e4f7f.js"><link rel="prefetch" href="/ngx_waf/assets/js/20.f3dc0cb0.js"><link rel="prefetch" href="/ngx_waf/assets/js/21.89dc6e87.js"><link rel="prefetch" href="/ngx_waf/assets/js/22.693df155.js"><link rel="prefetch" href="/ngx_waf/assets/js/23.2438c50d.js"><link rel="prefetch" href="/ngx_waf/assets/js/24.d9df1d40.js"><link rel="prefetch" href="/ngx_waf/assets/js/25.5b3cda8c.js"><link rel="prefetch" href="/ngx_waf/assets/js/26.a0a08fab.js"><link rel="prefetch" href="/ngx_waf/assets/js/27.1692ae8b.js"><link rel="prefetch" href="/ngx_waf/assets/js/28.6955cd66.js"><link rel="prefetch" href="/ngx_waf/assets/js/29.e35aa5fe.js"><link rel="prefetch" href="/ngx_waf/assets/js/3.28429520.js"><link rel="prefetch" href="/ngx_waf/assets/js/30.1ce809ba.js"><link rel="prefetch" href="/ngx_waf/assets/js/31.9ca332ff.js"><link rel="prefetch" href="/ngx_waf/assets/js/32.97a4d311.js"><link rel="prefetch" href="/ngx_waf/assets/js/33.b5bd0189.js"><link rel="prefetch" href="/ngx_waf/assets/js/34.59b7abe0.js"><link rel="prefetch" href="/ngx_waf/assets/js/35.717e9f22.js"><link rel="prefetch" href="/ngx_waf/assets/js/36.e0f98f9b.js"><link rel="prefetch" href="/ngx_waf/assets/js/4.e5a10528.js"><link rel="prefetch" href="/ngx_waf/assets/js/5.b1796519.js"><link rel="prefetch" href="/ngx_waf/assets/js/6.01e41ae3.js"><link rel="prefetch" href="/ngx_waf/assets/js/7.c8dbc414.js"><link rel="prefetch" href="/ngx_waf/assets/js/8.36764b10.js"><link rel="prefetch" href="/ngx_waf/assets/js/9.2f8022f4.js">
    <link rel="stylesheet" href="/ngx_waf/assets/css/0.styles.50317297.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/ngx_waf/" class="home-link router-link-active"><!----> <span class="site-name">ngx_waf</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ngx_waf/advance/priority.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/ngx_waf/zh-cn/advance/priority.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/ADD-SP/ngx_waf/" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Select language" class="dropdown-title"><span class="title">Languages</span> <span class="arrow down"></span></button> <button type="button" aria-label="Select language" class="mobile-dropdown-title"><span class="title">Languages</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/ngx_waf/advance/priority.html" aria-current="page" class="nav-link router-link-exact-active router-link-active">
  English
</a></li><li class="dropdown-item"><!----> <a href="/ngx_waf/zh-cn/advance/priority.html" class="nav-link">
  简体中文
</a></li></ul></div></div> <a href="https://github.com/ADD-SP/ngx_waf/" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><a href="/ngx_waf/guide/overview.html" class="sidebar-heading clickable"><span>Quick Start</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/ngx_waf/advance/syntax.html" class="sidebar-heading clickable open"><span>Advanced Guide</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/ngx_waf/advance/syntax.html" class="sidebar-link">Configuration syntax</a></li><li><a href="/ngx_waf/advance/rule.html" class="sidebar-link">Rule Description</a></li><li><a href="/ngx_waf/advance/priority.html" aria-current="page" class="active sidebar-link">Rule Priority</a></li><li><a href="/ngx_waf/advance/variable.html" class="sidebar-link">Built-in Variables</a></li><li><a href="/ngx_waf/advance/log.html" class="sidebar-link">Log</a></li><li><a href="/ngx_waf/advance/issue.html" class="sidebar-link">Known Issues</a></li><li><a href="/ngx_waf/advance/changes.html" class="sidebar-link">Changes</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="rule-priority"><a href="#rule-priority" class="header-anchor">#</a> Rule Priority</h1> <p>There are many inspection process in this module, so it is important to specify the inspection priority of each inspection process to avoid illogical inspection results.</p> <p>The following is a list of all the tests in order of priority, from top to bottom.</p> <ol><li>IP whitelist inspection</li> <li>IP blacklist inspection</li> <li>CC protection</li> <li>Url whitelist inspection</li> <li>Url blacklist inspection</li> <li>Get parameter blacklist inspection</li> <li>User-Agent blacklist inspection</li> <li>Referer whitelist inspection</li> <li>Referer blacklist inspection</li> <li>Cookie blacklist inspection</li> <li>Post request body blacklist</li></ol> <div class="custom-block tip"><p class="custom-block-title">Change priority</p> <p>You can modify the priority through the configuration file, but the priority of the POST request body detection is not allowed to be modified, it will always have the lowest priority. See <a href="/ngx_waf/advance/syntax.html#waf-priority">waf_priority</a> for details</p></div></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/ADD-SP/ngx_waf/edit/master/docs/advance/priority.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">4/24/2021, 12:59:37 PM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/ngx_waf/advance/rule.html" class="prev">
        Rule Description
      </a></span> <span class="next"><a href="/ngx_waf/advance/variable.html">
        Built-in Variables
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/ngx_waf/assets/js/app.782f3221.js" defer></script><script src="/ngx_waf/assets/js/2.765de306.js" defer></script><script src="/ngx_waf/assets/js/11.13f84e60.js" defer></script>
  </body>
</html>
